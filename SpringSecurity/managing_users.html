<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://assets.ubuntu.com/v1/vanilla-framework-version-4.5.1.min.css" />
  <title>Spring Security</title>
</head>

<body>
  <div class="l-docs">
    <div class="l-docs__header">
      <header id="navigation" class="p-navigation is-dark">
        <div class="l-docs__subgrid">
          <div class="l-docs__sidebar">
            <div class="p-navigation__banner">
              <div class="p-navigation__tagged-logo">
                <a class="p-navigation__link" href="#">
                  <div class="p-navigation__logo-tag">
                    <img class="p-navigation__logo-icon" src="https://assets.ubuntu.com/v1/82818827-CoF_white.svg"
                      alt="">
                  </div>
                  <span class="p-navigation__logo-title">Spring Security</span>
                </a>
              </div>
              <a href="#navigation" class="p-navigation__toggle--open" title="menu">Menu</a>
              <a href="#navigation-closed" class="p-navigation__toggle--close" title="close menu">Close menu</a>
            </div>
          </div>
          <div class="l-docs__main">
            <div class="p-navigation__row u-fixed-width">
              <nav class="p-navigation__nav" aria-label="Example main">
                <ul class="p-navigation__items">
                  <li class="p-navigation__item">
                    <a class="p-navigation__link" href="#">Products</a>
                  </li>
                  <li class="p-navigation__item">
                    <a class="p-navigation__link" href="#">Services</a>
                  </li>
                  <li class="p-navigation__item">
                    <a class="p-navigation__link" href="#">Partners</a>
                  </li>
                  <li class="p-navigation__item">
                    <a class="p-navigation__link" href="#">Docs</a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </header>
    </div>

    <aside class="l-docs__sidebar">
      <nav class="p-side-navigation--raw-html is-sticky" id="drawer" aria-label="Table of contents">
        <div class="u-hide--large p-strip is-shallow">
          <div class="u-fixed-width">
            <a href="#drawer" class="p-side-navigation__toggle js-drawer-toggle" aria-controls="drawer">
              Toggle side navigation
            </a>
          </div>
        </div>

        <div class="p-side-navigation__overlay js-drawer-toggle" aria-controls="drawer"></div>

        <div class="p-side-navigation__drawer">
          <div class="p-side-navigation__drawer-header">
            <a href="#" class="p-side-navigation__toggle--in-drawer js-drawer-toggle" aria-controls="drawer">
              Toggle side navigation
            </a>
          </div>
          <h3>Side navigation</h3>
          <ul>
            <li>
              <a class="is-active" href="managing_users.html">Managing Users</a>
            </li>
            <li>
              <a href="#">Second page</a>
            </li>
            <li>
              <a href="#">Third page</a>
            </li>
            <li>
              <strong>Sub section</strong>
              <ul>
                <li>
                  <a href="#">Second level link</a>
                </li>
                <li>
                  <a class="is-active" href="#">Current page</a>
                </li>
                <li>
                  <a href="#">Another second level link</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#">Last page</a>
            </li>
          </ul>

          <ul>
            <li>
              <a href="#"><strong>Another group</strong></a>
            </li>
            <li>
              <a href="#">First page</a>
            </li>
            <li>
              <a href="#">Second page</a>
            </li>
            <li>
              <a href="#">Third page</a>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <div class="l-docs__title" id="main-content">
      <div class="p-section--shallow">
        <div class="row">
          <div class="col-12">
            <h1>Managing Users</h1>
          </div>
        </div>
      </div>
    </div>

    <div class="l-docs__meta">
      <div class="l-docs__sticky-container">
        <aside class="p-table-of-contents">
          <div class="p-table-of-contents__section">
            <h2 class="p-table-of-contents__header">On this page</h2>
            <nav class="p-table-of-contents__nav" aria-label="Table of contents">
              <ul class="p-table-of-contents__list">
                <li class="p-table-of-contents__item"><a class="p-table-of-contents__link" href="#link1">
                    Authentication flow
                  </a></li>
                <li class="p-table-of-contents__item"><a class="p-table-of-contents__link" href="#link2">Describing the
                    user</a></li>
                <li class="p-table-of-contents__item"><a class="p-table-of-contents__link" href="#link3">
                    GrantedAuthority contract
                  </a></li>
                <li class="p-table-of-contents__item"><a class="p-table-of-contents__link" href="#link4">
                    Implementing UserDetails
                  </a></li>
                <li class="p-table-of-contents__item"><a class="p-table-of-contents__link" href="#link5">
                    How to manage users
                  </a></li>


              </ul>
            </nav>
          </div>
        </aside>
      </div>
    </div>

    <main class="l-docs__main">
      <div class="row">
        <div class="col-12">
          <p>Start with how Spring Security understands the user definition.
            For this, we’ll discuss the UserDetails and GrantedAuthority contracts.
            Then we’ll detail the UserDetailsService and how UserDetailsManager
            extends this contract. You’ll apply implementations for these interfaces (like
            InMemoryUserDetailsManager, JdbcUserDetailsManager, and
            LdapUserDetailsManager). When these implementations aren’t a good fit for
            your system, you’ll write a custom implementation.</p>

          <h2 id="link1">authentication flow</h2>

          <figure>
            <img class="p-image--bordered" src="auth_flow.jpg" alt="">
            <figcaption></figcaption>
          </figure>

          <ul>
            <li>AuthenticationFilter intercepts the
              request and delegates the authentication responsibility to the AuthenticationManager. </li>
            <li>
              To implement the authentication logic, the AuthenticationManager uses an authentication provider.
            </li>
            <li>
              To check the username and the password, the AuthenticationProvider uses a
              UserDetailsService and a PasswordEncoder.
            </li>
          </ul>

          <h3> user management</h3>

          <p>UserDetailsService and the PasswordEncoder</p>

          <p>
            the UserDetailsService and the PasswordEncoder are
            the components that deal directly with user details and their credentials
          </p>

          <p>
            UserDetailsService is only
            responsible for retrieving the user by username. This action is the only one
            needed by the framework to complete authentication. The
            UserDetailsManager adds behavior that refers to adding, modifying, or
            deleting the user
          </p>

          <p>
            To manage the users, UserDetailsService
            and the UserDetailsManager components need a way to represent them.
          </p>

          <p>
            The <code>UserDetails</code> interface is the structure used by Spring Security to understand the user. This
            has to be implemented.
          </p>

          <p>
            in Spring Security a user has a set of privileges,
            which are the actions the user is allowed to do
          </p>

          <p>
            Spring Security represents the actions that a user can do with the
            GrantedAuthority interface. We call these <i>authorities</i>, and
            a user has one or more authorities.
          </p>

          <figure>
            <img class="p-image--bordered" src="user_management.jpg" alt="">
            <figcaption></figcaption>
          </figure>

          <ul>
            <li>
              The UserDetailsService returns the details of a user, finding the user by its name.
            </li>
            <li>
              The UserDetails contract describes the user.
            </li>
            <li>
              A user has one or more authorities, represented by the
              GrantedAuthority interface.
            </li>
            <li>
              To add operations such as create, delete, or change password to the
              user, the UserDetailsManager contract extends UserDetailsService to add operations.
            </li>
          </ul>


          <h2 id="link2">Describing the user</h2>

          <p>
            We need to make Spring Security framework aware of our users so that Spring Security can handle them.
            For this we implement the <code>UserDetails</code> interface with our users.
          </p>

          <h3>The UserDetails interface</h3>

          <pre><code>
            public interface UserDetails extends Serializable {
              public String getUsername();
              public String getPassword();
              public Collection&lt? extends GrantedAuthority> getAuthorities();
              public boolean isAccountNonExpired();
              public boolean isAccountNonLocked();
              public boolean isCredentialsNonExpired();
              public boolean isEnabled();
            }
          </code></pre>

          <p>
            The getUsername() and getPassword() methods return, as you’d expect, the
            username and the password. The app uses these values in the process of
            authentication, and these are the only details related to authentication from
            this contract. The other five methods all relate to authorizing the user for
            accessing the application’s resources.
          </p>

          <p>
            Generally, the app should allow a user to do some actions that are meaningful
            in the application’s context. For example, the user should be able to read
            data, write data, or delete data. We say a user has or hasn’t the privilege to
            perform an action, and an authority represents the privilege a user has. We
            implement the getAuthorities() method to return the group of authorities
            granted for a user.
          </p>

          <p>
            Furthermore, as seen in the UserDetails contract, a user can:
          </p>

          <ul>
            <li>Let the account expire</li>
            <li>Lock the account</li>
            <li>Let the credentials expire</li>
            <li>Disable the account</li>
          </ul>

          <p>
            If you choose to implement these user restrictions in your application’s logic,
            you need to override the following methods: isAccountNonExpired(),
            isAccountNonLocked(), isCredentialsNonExpired(), isEnabled(), such
            that those needing to be enabled return true.
          </p>
          <p>
            Not all applications have
            accounts that expire or get locked with certain conditions. If you do not need
            to implement these functionalities in your application, you can simply make these four methods return true.

          </p>

          <div class="p-notification--information">
            <div class="p-notification__content">
              <h5 class="p-notification__title"><code>Collection&lt? extends GrantedAuthority></code> explanation</h5>
              <p class="p-notification__message">A collection is a group of objects in Java. the next part in triangle
                brackets is generics. The question mark and the <code>extends</code> means that the group of objects can
                be
                a type or subtype of <code>GrantedAuthority</code>. This allows for flexibility in the authorities. </p>
            </div>
          </div>

          <div class="p-notification--information">
            <div class="p-notification__content">
              <h5 class="p-notification__title"><code>extends Serializable</code> explanation</h5>
              <p class="p-notification__message">
                In Java, the Serializable interface is used to indicate that a class or interface can be serialized,
                meaning its instances can be converted into a byte stream. Serialization is the process of converting an
                object into a format that can be easily stored, transmitted, or reconstructed. In the case of the
                UserDetails interface from Spring Security, declaring that it extends Serializable serves several
                purposes:
              </p>
              <ul>
                <li>Session Persistence: When user authentication occurs in a web application, the user details,
                  including information provided by the UserDetails implementation, may be stored in a session. If the
                  server needs to serialize the session (for example, to persist it to a database or distribute it
                  across a cluster), the UserDetails objects must be serializable.
                </li>
                <li>
                  Caching: Some applications or frameworks might use caching mechanisms that involve serializing objects
                  for efficient storage and retrieval. If UserDetails objects are involved in such caching, they need to
                  be serializable.
                </li>
              </ul>
            </div>
          </div>

          <h2 id="link3">GrantedAuthority contract</h2>

          <p>
            the actions granted for a user are called authorities. We write authorization configurations based on these
            user
            authorities. So it’s essential to know how to define them.
          </p>

          <p>
            The authorities represent what the user can do in your application. Without
            authorities, all users would be equal.
          </p>
          <p>
            While there are simple applications in which the users are equal, in most practical scenarios, an
            application defines multiple kinds of users. An application might have users that can only read
            specific information, while others also can modify the data. And you need to
            make your application differentiate between them, depending on the
            functional requirements of the application, which are the authorities a user
            needs.
          </p>

          <p>
            To describe the authorities in Spring Security, you use the
            GrantedAuthority interface.
          </p>

          <p>
            We use this interface in the definition of the
            user details. It represents a privilege granted to the user. A user must have at
            least one authority. Here’s the implementation of the GrantedAuthority
            definition:
          </p>

          <pre>
            <code>
              public interface GrantedAuthority extends Serializable {
                String getAuthority();
              }
            </code>
          </pre>

          <p>
            To create an authority, you only need to find a name for that privilege so you
            can refer to it later when writing the authorization rules. For example, a user
            can read the records managed by the application or delete them. You write
            the authorization rules based on the names you give to these actions.
          </p>

          <p>
            Here we’ll implement the getAuthority() method to return the
            authority’s name as a String. The GrantedAuthority interface has only one
            abstract method, and in this book, you often find examples in which we use a
            lambda expression for its implementation. Another possibility is to use the
            SimpleGrantedAuthority class to create authority instances. The
            SimpleGrantedAuthority class offers a way to create immutable instances of
            the type GrantedAuthority. You provide the authority name when building
            the instance. In the next code snippet, you’ll find two examples of
            implementing a GrantedAuthority. Here we make use of a lambda
            expression and then use the SimpleGrantedAuthority class:
          </p>

          <pre>
            <code>
              GrantedAuthority g1 = () -> "READ";
              GrantedAuthority g2 = new SimpleGrantedAuthority("READ");
            </code>
          </pre>

          <h2 id="link4">Implementing UserDetails</h2>

          <p>
            For a real application, you
            should create a class that you can use to generate instances that can represent
            different users. In this case, your definition would at least have the username
            and the password as attributes in the class.

          </p>

          <p>
            When we use a database with Spring Security, it's best to separate the entity class from the security user
            class which implements <code>UserDetails</code>. This is because there is a mixing of responsibilities in
            same
            class and makes things messy.
          </p>

          <p>
            So we separate them by creating a user <code>SecurityUser</code> which implements <code>UserDetails</code>,
            and
            a separate <code>@Entity</code> class which will be used to save the user in the database. We inject the
            entity
            user into the SecurityUser so that it can be used by Spring Security.
          </p>

          <pre>
            <code>
              public class SecurityUser implements UserDetails {

                private final DatabaseUser user;

                public SecurityUser(DatabaseUser user){
                  this.user = user;
                }

                @Override
                public String getUsername(){
                  return this.user.getUsername();
                }

                @Override
                public String getPassword(){
                  return this.user.getPassword();
                }

                @Override
                public Collection&lt? extends GrantedAuthority> getAuthorities(){
                  return List.of(() -> this.user.getAuthority());
                }

                @Override
                public boolean isAccountNonExpired(){
                  return true;
                }

                @Override
                public boolean isAccountNonLocked(){
                  return true;
                }

                @Override
                public boolean isCredentialsNonExpired(){
                  return true;
                }

                @Override
                public boolean isEnabled(){
                  return true;
                }

              }
            </code>
          </pre>

          <pre>
            <code>
              @Entity
              public class DatabaseUser {
                @Id
                private Long id;
                private String username;
                private String password;
                private String authority;
                // Omitted getters and setters
              }

            </code>
          </pre>

          <h2 id="link5"> Instructing Spring Security on how to manage users
          </h2>

          <p>
            In the previous section, you implemented the UserDetails contract to
            describe users such that Spring Security understands them. But how does
            Spring Security manage users? Where are they taken from when comparing
            credentials, and how do you add new users or change existing ones? In
            chapter 2, you learned that the framework defines a specific component to
            which the authentication process delegates user management: the UserDetailsService
            instance. We even defined a UserDetailsService to override the default implementation
            provided by Spring Boot.

          </p>

          <p>
            In this section, we experiment with various ways of implementing the
            UserDetailsService class. You’ll understand how user management works
            by implementing the responsibility described by the UserDetailsService
            contract in our example. After that, you’ll find out how the
            UserDetailsManager interface adds more behavior to the contract defined by
            the UserDetailsService. At the end of this section, we’ll use the provided
            implementations of the UserDetailsManager interface offered by Spring
            Security. We’ll write an example project where we’ll use one of the best
            known implementations provided by Spring Security, the
            JdbcUserDetailsManager class. Learning this, you’ll know how to tell
            Spring Security where to find users, which is essential in the authentication
            flow.

          </p>

          <h3>
            Understanding the UserDetailsService contract
          </h3>

          <p>
            The UserDetailsService interface contains only one method, as follows:
          </p>

          <pre>
            <code>
              public interface UserDetailsService {
                UserDetails loadUserByUsername(String username) throws UsernameNotFoundException;
              }
            </code>
          </pre>

          <figure>
            <img class="p-image--bordered" src="userDetailsService.jpg" alt="">
            <figcaption>
              The AuthenticationProvider is the component that implements the authentication
              logic and uses the UserDetailsService to load details about the user. To find the user by
              username, it calls the loadUserByUsername(String username) method.
            </figcaption>
          </figure>



          <p>
            The authentication implementation calls the loadUserByUsername(String
            username) method to obtain the details of a user with a given username.
            The username is, of course, considered unique. The user returned
            by this method is an implementation of the UserDetails contract. If the
            username doesn’t exist, the method throws a UsernameNotFoundException.

          </p>


          <div class="p-notification">
            <p class="p-notification__content">
              The UsernameNotFoundException is a RuntimeException. The throws
              clause in the UserDetailsService interface is only for documentation
              purposes. The UsernameNotFoundException inherits directly from the type
              AuthenticationException, which is the parent of all the exceptions related
              to the process of authentication. AuthenticationException inherits further
              the RuntimeException class.
            </p>
          </div>

          <h3>Implementing the UserDetailsService contract: using InMemoryUserDetailsService</h3>

          <p>
            Your application manages
            details about credentials and other user aspects. It could be that these are
            stored in a database or handled by another system that you access through a
            web service or by other means. Regardless of how this happens in
            your system, the only thing Spring Security needs from you is an
            implementation to retrieve the user by username.

          </p>

          <pre>
            <code>
              public class User implements UserDetails {

                private final String username;
                private final String password;
                private final String authority;

                public User(String username, String password, String authority){
                  this.username = username;
                  this.password = password;
                  this.authority = authority;
                }

                @Override
                public String getUsername(){
                  return username;
                }

                @Override
                public String getPassword(){
                  return password;
                }

                @Override
                public Collection&lt? extends GrantedAuthority> getAuthorities(){
                  return List.of(() -> authority);
                }

                @Override
                public boolean isAccountNonExpired(){
                  return true;
                }

                @Override
                public boolean isAccountNonLocked(){
                  return true;
                }

                @Override
                public boolean isCredentialsNonExpired(){
                  return true;
                }

                @Override
                public boolean isEnabled(){
                  return true;
                }

              }
            </code>
          </pre>

          <p>
            In the package named services, we create a class called
            InMemoryUserDetailsService. The following listing shows how we
            implement this class.
          </p>

          <pre>
            <code>
              public class InMemoryUserDetailsService implements UserDetailsService {
                private final List&ltUserDetails> users;

                public InMemoryUserDetailsService(List&ltUserDetails> users){
                  this.users = users;
                }

                @Override
                public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException{
                  return users.stream()
                              .filter(
                                u -> u.getUsername().equals(username)
                              )
                              .findFirst()
                              .orElseThrow(
                                () -> new UsernameNotFoundException("User not found")
                              )
                }
              }
            </code>
          </pre>

          <p>
            The loadUserByUsername(String username) method searches the list of
            users for the given username and returns the desired UserDetails instance. If
            there is no instance with that username, it throws a
            UsernameNotFoundException.
          </p>

          <p>
            We can now use this implementation as our
            UserDetailsService. The next listing shows how we add it as a bean in the
            configuration class and register one user within it.
          </p>

          <pre>
            <code>
              @Configuration
              public class ProjectConfig {

                @Bean
                public UserDetailsService userDetailsService() {
                  UserDetails u = new User("john", "123", "read");
                  List&ltUserDetails> users = List.of(u);
                  return new InMemoryUserDetailsService(users);
                }

                @Bean
                public PasswordEncoder passwordEncoder() {
                  return NoOpPasswordEncoder.getInstance();
                }
              }
            </code>
          </pre>

          <p>
            Make a test endpoint:
          </p>

          <pre>
            <code>
              @RestController
              public class HelloController {
                @GetMapping("/hello")
                public String hello() {
                  return "Hello!";
                }
              }
            </code>
          </pre>

          <p>
            When calling the endpoint using cURL, we observe that for user John with
            password 12345, we get back an HTTP 200 OK. If we use something else,
            the application returns 401 Unauthorized.

          </p>

          <p>
            <code>
              curl -u john:12345 http://localhost:8080/hello
            </code>

          </p>

          <h3>
            Implementing the UserDetailsManager interface
          </h3>

          <p>
            This interface extends and adds more methods to the
            UserDetailsService contract.
          </p>

          <p>
            Spring Security needs the
            UserDetailsService contract to do the authentication. But generally, in
            applications, there is also a need for managing users.
          </p>

          <p>
            Most of the time, an app
            should be able to add new users or delete existing ones. In this case, we
            implement a more particular interface defined by Spring Security,
            UserDetailsManager. It extends UserDetailsService and adds more
            operations that we need to implement.
          </p>

          <pre>
            <code>
              public interface UserDetailsManager extends UserDetailsService {
                void createUser(UserDetails user);
                void updateUser(UserDetails user);
                void deleteUser(UserDetails user);
                void changePassword(String oldPassword, String newPassword);
                boolean userExists(UserDetails user);
              }
            </code>
          </pre>

          <p>
            The InMemoryUserDetailsManager object is actually a UserDetailsManager.
          </p>

          <h3>Implementing the UserDetailsService interface: using a JdbcUserDetailsManager for user management</h3>

          <p>
            The JdbcUserDetailsManager class manages users in an SQL database. It
            connects to the database directly through JDBC. This way, the
            JdbcUserDetailsManager is independent of any other framework or
            specification related to database connectivity.
          </p>

          <p>
            To understand how the JdbcUserDetailsManager works, it’s best if you put
            it into action with an example. In the following example, you implement an
            application that manages the users in a MySQL database using the
            JdbcUserDetailsManager. Figure 3.4 provides an overview of the place the
            JdbcUserDetailsManager implementation takes in the authentication flow.
          </p>


          <figure>
            <img class="p-image--bordered" src="JdbcUserDetailsManager.jpg" alt="">
            <figcaption>
              The AuthenticationProvider is the component that implements the authentication
              logic and uses the UserDetailsService to load details about the user. To find the user by
              username, it calls the loadUserByUsername(String username) method.
            </figcaption>
          </figure>


          <p>
            how to use the
            JdbcUserDetailsManager by creating a database and two tables. In our case,
            we name the database spring, and we name one of the tables users and the
            other authorities. These names are the default table names known by the
            JdbcUserDetailsManager.
          </p>

          <p>
            The JdbcUserDetailsManager implementation is flexible and lets you override
            these default names if you want to do so. The purpose of the users table is to
            keep user records. The JdbcUserDetailsManager implementation expects
            three columns in the users table: a username, a password, and enabled, which
            you can use to deactivate the user.
          </p>

          <p>
            You can choose to create the database and its structure yourself either by
            using the command-line tool for your database management system (DBMS)
            or a client application. For example, for MySQL, you can choose to use
            MySQL Workbench to do this.
          </p>

          <p>
            The easiest would be to let Spring Boot itself run the scripts for you.
            To do this, just add two more files to your project in the resources folder:
          </p>
          <ul>
            <li>
              schema.sql
            </li>
            <li>
              data.sql
            </li>
          </ul>

          <p>
            In the schema.sql
            file, you add the queries related to the structure of the database, like creating,
            altering, or dropping tables.
          </p>

          <p>
            In the data.sql file, you add the queries that work
            with the data inside the tables, like INSERT, UPDATE, or DELETE.
          </p>

          <p>
            Spring Boot
            automatically runs these files for you when you start the application.
          </p>

          <p>
            A
            simpler solution for building examples that need databases is using an H2 inmemory database. This way, you
            don’t need to install a separate DBMS
            solution.
          </p>

          <p>
            You use the code in the next listing to create the users table with a MySQL
            server. You can add this script to the schema.sql file in your Spring Boot
            project.
          </p>

          <pre>
            <code>
              CREATE TABLE IF NOT EXISTS `spring`.`users` (
                `id` INT NOT NULL AUTO_INCREMENT,
                `username` VARCHAR(45) NOT NULL,
                `password` VARCHAR(45) NOT NULL,
                `enabled` INT NOT NULL,
                PRIMARY KEY (`id`));

            </code>
          </pre>

          <p>
            The authorities table stores authorities per user. Each record stores a
            username and an authority granted for the user with that username.
          </p>

          <pre>
            <code>
              CREATE TABLE IF NOT EXISTS `spring`.`authorities` (
                `id` INT NOT NULL AUTO_INCREMENT,
                `username` VARCHAR(45) NOT NULL,
                `authority` VARCHAR(45) NOT NULL,
                PRIMARY KEY (`id`));
            </code>
          </pre>

          <p>
            To make sure you have a user for testing, insert a record in each of the tables.
            You can add these queries in the data.sql file in the resources folder of the
            Spring Boot project:

          </p>

          <pre>
            <code>
              INSERT INTO `spring`.`authorities`
              (username, authority)
              VALUES
              ('john', 'write');
              INSERT INTO `spring`.`users`
              (username, password, enabled)
              VALUES
              ('john', '12345', '1');
            </code>
          </pre>

          <p>
            For your project, you need to add at least the dependencies stated in the
            following listing. Check your pom.xml file to make sure you added these
            dependencies.
          </p>

          <pre>
            <code>
              &ltdependency>
                &ltgroupId>org.springframework.boot&lt/groupId>
                &ltartifactId>spring-boot-starter-security&lt/artifactId>
              &lt/dependency>
              &ltdependency>
                &ltgroupId>org.springframework.boot&lt/groupId>
                &ltartifactId>spring-boot-starter-web&lt/artifactId>
              &lt/dependency>
              &ltdependency>
                &ltgroupId>org.springframework.boot&lt/groupId>
                &ltartifactId>spring-boot-starter-jdbc&lt/artifactId>
              &lt/dependency>
              &ltdependency>
                &ltgroupId>com.h2database&lt/groupId>
                &ltartifactId>h2&lt/artifactId>
              &lt/dependency>   
            </code>
          </pre>

          <p>
            Remember, you need to add the JDBC driver according to the database
            technology you use. For example, if you’d use MySQL, you need to add the
            MySQL driver dependency as presented in the next snippet.
          </p>

          <pre>
            <code>
              &ltdependency>
                &ltgroupId>mysql&lt/groupId>
                &ltartifactId>mysql-connector-java&lt/artifactId>
                &ltscope>runtime&lt/scope>
              &lt/dependency>
            </code>
          </pre>

          <p>
            You can configure a data source in the application.properties file of the
            project or as a separate bean. If you choose to use the application.properties
            file, you need to add the following lines to that file:
          </p>

          <pre>
            <code>
spring.datasource.url=jdbc:h2:mem:ssia
spring.datasource.username=sa
spring.datasource.password=
spring.sql.init.mode=always

            </code>
          </pre>

          <p>
            In the configuration class of the project, you define the UserDetailsService
            and the PasswordEncoder. The JdbcUserDetailsManager needs the
            DataSource to connect to the database. The data source can be autowired
            through a parameter of the method (as presented in the next listing) or
            through an attribute of the class
          </p>

          <pre>
            <code>
              @Configuration
              public class ProjectConfig {

                @Bean
                public UserDetailsService userDetailsService(DataSource datasource){
                  return new JdbcUserDetailsManager(dataSource);
                }

                @Bean
                public PasswordEncoder passwordEncoder(){
                  return NoOpPasswordEncoder.getInstance();
                }
              }
            </code>
          </pre>

          <p>
            To access any endpoint of the application, you now need to use HTTP Basic
            authentication with one of the users stored in the database. To prove this, we
            create a new endpoint as shown in the following listing and then call it with
            cURL.

          </p>

          <pre>
            <code>
              @RestController
              public class HelloController {
                @GetMapping("/hello")
                public String hello() {
                  return "Hello!";
                }
              }
            </code>
          </pre>



          <h3>Tables</h3>
          <table aria-label="MAAS table example">
            <thead>
              <tr>
                <th>Interface name</th>
                <th>Description</th>
                <th>Auto-connect</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="#docs/account-control-interface">account-control</a></td>
                <td>add/remove user accounts or change passwords</td>
                <td>no</td>
              </tr>
              <tr>
                <td><a href="#docs/accounts-service-interface">accounts-service</a></td>
                <td>allows communication with the accounts service</td>
                <td>no</td>
              </tr>
              <tr>
                <td><a href="#docs/adb-support-interface">adb-support</a></td>
                <td>allows operating as Android Debug Bridge service</td>
                <td>no</td>
              </tr>
              <tr>
                <td><a href="#docs/alsa-interface">alsa</a></td>
                <td>play or record sound</td>
                <td>no</td>
              </tr>
              <tr>
                <td><a href="#docs/appstream-metadata-interface">appstream-metadata</a></td>
                <td>allows access to AppStream metadata</td>
                <td>no</td>
              </tr>
            </tbody>
          </table>

          <h3>Notifications</h3>

          <div class="p-notification">
            <p class="p-notification__content">
              In versions prior to <code>v.2.6.1</code> the <code>add-cloud</code> command only operates locally (there
              is no <code>--local</code> option).
            </p>
          </div>

          <div class="p-notification--caution">
            <p class="p-notification__content">
              Multi-cloud functionality via <code>add-cloud</code> (not <code>add-k8s</code>) is available as “early
              access” and requires the use of a feature flag. Once the controller
              is created, you can enable it with: <code>juju controller-config features="[multi-cloud]"</code>
            </p>
          </div>

          <div class="p-notification--information">
            <p class="p-notification__content">
              Last updated 29 days ago.
              <a href="#clouds/1100">Help improve this document in the forum</a>.
            </p>
          </div>

          <h3>Grid</h3>

          <p>Main documentation content block is contained in grid <code>col-9</code>.</p>

          <p>For two columns split use two <code>col-4</code> columns.</p>
          <div class="row">
            <div class="col-4">
              <ul class="p-list">
                <li class="p-list__item"><a href="#docs/whats-new-2-6">New features in 2.6&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/clouds">Clouds&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/vsphere-cloud">Using VMware vSphere with Juju&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/k8s-cloud">Using Kubernetes with Juju&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/k8s-charms-tutorial">Understanding Kubernetes charms&nbsp;›</a>
                </li>
              </ul>
            </div>
            <div class="col-4">
              <ul class="p-list">
                <li class="p-list__item"><a href="#docs/migrating-models">Migrating models&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/bundle-reference">Bundle reference&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/microk8s-cloud">Using Juju with MicroK8s&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/removing-things">Removing things&nbsp;›</a></li>
                <li class="p-list__item"><a href="#docs/controller-logins">Controller logins&nbsp;›</a></li>
              </ul>
            </div>
          </div>

          <p>For three columns split use three <code>col-3</code> columns.</p>

          <div class="row">
            <div class="col-3">
              <ul class="p-list--divided">
                <li class="p-list__item"><a href="#docs/settings/animation-settings">Animation</a></li>
                <li class="p-list__item"><a href="#docs/settings/assets-settings">Assets</a></li>
                <li class="p-list__item"><a href="#docs/settings/breakpoint-settings">Breakpoint</a></li>
              </ul>
            </div>
            <div class="col-3">
              <ul class="p-list--divided">
                <li class="p-list__item"><a href="#docs/settings/color-settings">Color</a></li>
                <li class="p-list__item"><a href="#docs/settings/font-settings">Font</a></li>
                <li class="p-list__item"><a href="#docs/settings/layout-settings">Layout</a></li>
              </ul>
            </div>
            <div class="col-3">
              <ul class="p-list--divided">
                <li class="p-list__item"><a href="#docs/settings/placeholder-settings">Placeholder</a></li>
                <li class="p-list__item"><a href="#docs/settings/spacing-settings">Spacing</a></li>
              </ul>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>


  <div class="l-docs__footer">
    <footer class="p-strip--dark l-docs__subgrid">
      <div class="l-docs__sidebar">
        <p style="padding-left: 1.5rem">© 2020 Canonical Ltd.</p>
      </div>
      <div class="l-docs__main">
        <nav class="row" aria-label="Footer">
          <div class="has-cookie">
            <p><a class="is-dark" href="#">Ubuntu</a> and <a class="is-dark" href="#">Canonical</a> are registered
              trademarks of Canonical Ltd.</p>
            <ul class="p-inline-list--middot">
              <li class="p-inline-list__item">
                <a class="is-dark" href="#"><small>Legal information</small></a>
              </li>
              <li class="p-inline-list__item">
                <a class="is-dark" href="#"><small>Report a bug on this site</small></a>
              </li>
            </ul>
            <span class="u-off-screen"><a href="#">Go to the top of the page</a></span>
          </div>
        </nav>
      </div>
    </footer>
  </div>

</body>

</html>